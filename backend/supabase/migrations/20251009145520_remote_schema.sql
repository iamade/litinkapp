revoke delete on table "public"."audio_exports" from "anon";

revoke insert on table "public"."audio_exports" from "anon";

revoke references on table "public"."audio_exports" from "anon";

revoke select on table "public"."audio_exports" from "anon";

revoke trigger on table "public"."audio_exports" from "anon";

revoke truncate on table "public"."audio_exports" from "anon";

revoke update on table "public"."audio_exports" from "anon";

revoke delete on table "public"."audio_exports" from "authenticated";

revoke insert on table "public"."audio_exports" from "authenticated";

revoke references on table "public"."audio_exports" from "authenticated";

revoke select on table "public"."audio_exports" from "authenticated";

revoke trigger on table "public"."audio_exports" from "authenticated";

revoke truncate on table "public"."audio_exports" from "authenticated";

revoke update on table "public"."audio_exports" from "authenticated";

revoke delete on table "public"."audio_exports" from "service_role";

revoke insert on table "public"."audio_exports" from "service_role";

revoke references on table "public"."audio_exports" from "service_role";

revoke select on table "public"."audio_exports" from "service_role";

revoke trigger on table "public"."audio_exports" from "service_role";

revoke truncate on table "public"."audio_exports" from "service_role";

revoke update on table "public"."audio_exports" from "service_role";

revoke delete on table "public"."audio_generations" from "anon";

revoke insert on table "public"."audio_generations" from "anon";

revoke references on table "public"."audio_generations" from "anon";

revoke select on table "public"."audio_generations" from "anon";

revoke trigger on table "public"."audio_generations" from "anon";

revoke truncate on table "public"."audio_generations" from "anon";

revoke update on table "public"."audio_generations" from "anon";

revoke delete on table "public"."audio_generations" from "authenticated";

revoke insert on table "public"."audio_generations" from "authenticated";

revoke references on table "public"."audio_generations" from "authenticated";

revoke select on table "public"."audio_generations" from "authenticated";

revoke trigger on table "public"."audio_generations" from "authenticated";

revoke truncate on table "public"."audio_generations" from "authenticated";

revoke update on table "public"."audio_generations" from "authenticated";

revoke delete on table "public"."audio_generations" from "service_role";

revoke insert on table "public"."audio_generations" from "service_role";

revoke references on table "public"."audio_generations" from "service_role";

revoke select on table "public"."audio_generations" from "service_role";

revoke trigger on table "public"."audio_generations" from "service_role";

revoke truncate on table "public"."audio_generations" from "service_role";

revoke update on table "public"."audio_generations" from "service_role";

revoke delete on table "public"."badges" from "anon";

revoke insert on table "public"."badges" from "anon";

revoke references on table "public"."badges" from "anon";

revoke select on table "public"."badges" from "anon";

revoke trigger on table "public"."badges" from "anon";

revoke truncate on table "public"."badges" from "anon";

revoke update on table "public"."badges" from "anon";

revoke delete on table "public"."badges" from "authenticated";

revoke insert on table "public"."badges" from "authenticated";

revoke references on table "public"."badges" from "authenticated";

revoke select on table "public"."badges" from "authenticated";

revoke trigger on table "public"."badges" from "authenticated";

revoke truncate on table "public"."badges" from "authenticated";

revoke update on table "public"."badges" from "authenticated";

revoke delete on table "public"."badges" from "service_role";

revoke insert on table "public"."badges" from "service_role";

revoke references on table "public"."badges" from "service_role";

revoke select on table "public"."badges" from "service_role";

revoke trigger on table "public"."badges" from "service_role";

revoke truncate on table "public"."badges" from "service_role";

revoke update on table "public"."badges" from "service_role";

revoke delete on table "public"."book_embeddings" from "anon";

revoke insert on table "public"."book_embeddings" from "anon";

revoke references on table "public"."book_embeddings" from "anon";

revoke select on table "public"."book_embeddings" from "anon";

revoke trigger on table "public"."book_embeddings" from "anon";

revoke truncate on table "public"."book_embeddings" from "anon";

revoke update on table "public"."book_embeddings" from "anon";

revoke delete on table "public"."book_embeddings" from "authenticated";

revoke insert on table "public"."book_embeddings" from "authenticated";

revoke references on table "public"."book_embeddings" from "authenticated";

revoke select on table "public"."book_embeddings" from "authenticated";

revoke trigger on table "public"."book_embeddings" from "authenticated";

revoke truncate on table "public"."book_embeddings" from "authenticated";

revoke update on table "public"."book_embeddings" from "authenticated";

revoke delete on table "public"."book_embeddings" from "service_role";

revoke insert on table "public"."book_embeddings" from "service_role";

revoke references on table "public"."book_embeddings" from "service_role";

revoke select on table "public"."book_embeddings" from "service_role";

revoke trigger on table "public"."book_embeddings" from "service_role";

revoke truncate on table "public"."book_embeddings" from "service_role";

revoke update on table "public"."book_embeddings" from "service_role";

revoke delete on table "public"."book_sections" from "anon";

revoke insert on table "public"."book_sections" from "anon";

revoke references on table "public"."book_sections" from "anon";

revoke select on table "public"."book_sections" from "anon";

revoke trigger on table "public"."book_sections" from "anon";

revoke truncate on table "public"."book_sections" from "anon";

revoke update on table "public"."book_sections" from "anon";

revoke delete on table "public"."book_sections" from "authenticated";

revoke insert on table "public"."book_sections" from "authenticated";

revoke references on table "public"."book_sections" from "authenticated";

revoke select on table "public"."book_sections" from "authenticated";

revoke trigger on table "public"."book_sections" from "authenticated";

revoke truncate on table "public"."book_sections" from "authenticated";

revoke update on table "public"."book_sections" from "authenticated";

revoke delete on table "public"."book_sections" from "service_role";

revoke insert on table "public"."book_sections" from "service_role";

revoke references on table "public"."book_sections" from "service_role";

revoke select on table "public"."book_sections" from "service_role";

revoke trigger on table "public"."book_sections" from "service_role";

revoke truncate on table "public"."book_sections" from "service_role";

revoke update on table "public"."book_sections" from "service_role";

revoke delete on table "public"."books" from "anon";

revoke insert on table "public"."books" from "anon";

revoke references on table "public"."books" from "anon";

revoke select on table "public"."books" from "anon";

revoke trigger on table "public"."books" from "anon";

revoke truncate on table "public"."books" from "anon";

revoke update on table "public"."books" from "anon";

revoke delete on table "public"."books" from "authenticated";

revoke insert on table "public"."books" from "authenticated";

revoke references on table "public"."books" from "authenticated";

revoke select on table "public"."books" from "authenticated";

revoke trigger on table "public"."books" from "authenticated";

revoke truncate on table "public"."books" from "authenticated";

revoke update on table "public"."books" from "authenticated";

revoke delete on table "public"."books" from "service_role";

revoke insert on table "public"."books" from "service_role";

revoke references on table "public"."books" from "service_role";

revoke select on table "public"."books" from "service_role";

revoke trigger on table "public"."books" from "service_role";

revoke truncate on table "public"."books" from "service_role";

revoke update on table "public"."books" from "service_role";

revoke delete on table "public"."chapter_embeddings" from "anon";

revoke insert on table "public"."chapter_embeddings" from "anon";

revoke references on table "public"."chapter_embeddings" from "anon";

revoke select on table "public"."chapter_embeddings" from "anon";

revoke trigger on table "public"."chapter_embeddings" from "anon";

revoke truncate on table "public"."chapter_embeddings" from "anon";

revoke update on table "public"."chapter_embeddings" from "anon";

revoke delete on table "public"."chapter_embeddings" from "authenticated";

revoke insert on table "public"."chapter_embeddings" from "authenticated";

revoke references on table "public"."chapter_embeddings" from "authenticated";

revoke select on table "public"."chapter_embeddings" from "authenticated";

revoke trigger on table "public"."chapter_embeddings" from "authenticated";

revoke truncate on table "public"."chapter_embeddings" from "authenticated";

revoke update on table "public"."chapter_embeddings" from "authenticated";

revoke delete on table "public"."chapter_embeddings" from "service_role";

revoke insert on table "public"."chapter_embeddings" from "service_role";

revoke references on table "public"."chapter_embeddings" from "service_role";

revoke select on table "public"."chapter_embeddings" from "service_role";

revoke trigger on table "public"."chapter_embeddings" from "service_role";

revoke truncate on table "public"."chapter_embeddings" from "service_role";

revoke update on table "public"."chapter_embeddings" from "service_role";

revoke delete on table "public"."chapter_scripts" from "anon";

revoke insert on table "public"."chapter_scripts" from "anon";

revoke references on table "public"."chapter_scripts" from "anon";

revoke select on table "public"."chapter_scripts" from "anon";

revoke trigger on table "public"."chapter_scripts" from "anon";

revoke truncate on table "public"."chapter_scripts" from "anon";

revoke update on table "public"."chapter_scripts" from "anon";

revoke delete on table "public"."chapter_scripts" from "authenticated";

revoke insert on table "public"."chapter_scripts" from "authenticated";

revoke references on table "public"."chapter_scripts" from "authenticated";

revoke select on table "public"."chapter_scripts" from "authenticated";

revoke trigger on table "public"."chapter_scripts" from "authenticated";

revoke truncate on table "public"."chapter_scripts" from "authenticated";

revoke update on table "public"."chapter_scripts" from "authenticated";

revoke delete on table "public"."chapter_scripts" from "service_role";

revoke insert on table "public"."chapter_scripts" from "service_role";

revoke references on table "public"."chapter_scripts" from "service_role";

revoke select on table "public"."chapter_scripts" from "service_role";

revoke trigger on table "public"."chapter_scripts" from "service_role";

revoke truncate on table "public"."chapter_scripts" from "service_role";

revoke update on table "public"."chapter_scripts" from "service_role";

revoke delete on table "public"."chapters" from "anon";

revoke insert on table "public"."chapters" from "anon";

revoke references on table "public"."chapters" from "anon";

revoke select on table "public"."chapters" from "anon";

revoke trigger on table "public"."chapters" from "anon";

revoke truncate on table "public"."chapters" from "anon";

revoke update on table "public"."chapters" from "anon";

revoke delete on table "public"."chapters" from "authenticated";

revoke insert on table "public"."chapters" from "authenticated";

revoke references on table "public"."chapters" from "authenticated";

revoke select on table "public"."chapters" from "authenticated";

revoke trigger on table "public"."chapters" from "authenticated";

revoke truncate on table "public"."chapters" from "authenticated";

revoke update on table "public"."chapters" from "authenticated";

revoke delete on table "public"."chapters" from "service_role";

revoke insert on table "public"."chapters" from "service_role";

revoke references on table "public"."chapters" from "service_role";

revoke select on table "public"."chapters" from "service_role";

revoke trigger on table "public"."chapters" from "service_role";

revoke truncate on table "public"."chapters" from "service_role";

revoke update on table "public"."chapters" from "service_role";

revoke delete on table "public"."character_archetypes" from "anon";

revoke insert on table "public"."character_archetypes" from "anon";

revoke references on table "public"."character_archetypes" from "anon";

revoke select on table "public"."character_archetypes" from "anon";

revoke trigger on table "public"."character_archetypes" from "anon";

revoke truncate on table "public"."character_archetypes" from "anon";

revoke update on table "public"."character_archetypes" from "anon";

revoke delete on table "public"."character_archetypes" from "authenticated";

revoke insert on table "public"."character_archetypes" from "authenticated";

revoke references on table "public"."character_archetypes" from "authenticated";

revoke select on table "public"."character_archetypes" from "authenticated";

revoke trigger on table "public"."character_archetypes" from "authenticated";

revoke truncate on table "public"."character_archetypes" from "authenticated";

revoke update on table "public"."character_archetypes" from "authenticated";

revoke delete on table "public"."character_archetypes" from "service_role";

revoke insert on table "public"."character_archetypes" from "service_role";

revoke references on table "public"."character_archetypes" from "service_role";

revoke select on table "public"."character_archetypes" from "service_role";

revoke trigger on table "public"."character_archetypes" from "service_role";

revoke truncate on table "public"."character_archetypes" from "service_role";

revoke update on table "public"."character_archetypes" from "service_role";

revoke delete on table "public"."characters" from "anon";

revoke insert on table "public"."characters" from "anon";

revoke references on table "public"."characters" from "anon";

revoke select on table "public"."characters" from "anon";

revoke trigger on table "public"."characters" from "anon";

revoke truncate on table "public"."characters" from "anon";

revoke update on table "public"."characters" from "anon";

revoke delete on table "public"."characters" from "authenticated";

revoke insert on table "public"."characters" from "authenticated";

revoke references on table "public"."characters" from "authenticated";

revoke select on table "public"."characters" from "authenticated";

revoke trigger on table "public"."characters" from "authenticated";

revoke truncate on table "public"."characters" from "authenticated";

revoke update on table "public"."characters" from "authenticated";

revoke delete on table "public"."characters" from "service_role";

revoke insert on table "public"."characters" from "service_role";

revoke references on table "public"."characters" from "service_role";

revoke select on table "public"."characters" from "service_role";

revoke trigger on table "public"."characters" from "service_role";

revoke truncate on table "public"."characters" from "service_role";

revoke update on table "public"."characters" from "service_role";

revoke delete on table "public"."image_generations" from "anon";

revoke insert on table "public"."image_generations" from "anon";

revoke references on table "public"."image_generations" from "anon";

revoke select on table "public"."image_generations" from "anon";

revoke trigger on table "public"."image_generations" from "anon";

revoke truncate on table "public"."image_generations" from "anon";

revoke update on table "public"."image_generations" from "anon";

revoke delete on table "public"."image_generations" from "authenticated";

revoke insert on table "public"."image_generations" from "authenticated";

revoke references on table "public"."image_generations" from "authenticated";

revoke select on table "public"."image_generations" from "authenticated";

revoke trigger on table "public"."image_generations" from "authenticated";

revoke truncate on table "public"."image_generations" from "authenticated";

revoke update on table "public"."image_generations" from "authenticated";

revoke delete on table "public"."image_generations" from "service_role";

revoke insert on table "public"."image_generations" from "service_role";

revoke references on table "public"."image_generations" from "service_role";

revoke select on table "public"."image_generations" from "service_role";

revoke trigger on table "public"."image_generations" from "service_role";

revoke truncate on table "public"."image_generations" from "service_role";

revoke update on table "public"."image_generations" from "service_role";

revoke delete on table "public"."learning_content" from "anon";

revoke insert on table "public"."learning_content" from "anon";

revoke references on table "public"."learning_content" from "anon";

revoke select on table "public"."learning_content" from "anon";

revoke trigger on table "public"."learning_content" from "anon";

revoke truncate on table "public"."learning_content" from "anon";

revoke update on table "public"."learning_content" from "anon";

revoke delete on table "public"."learning_content" from "authenticated";

revoke insert on table "public"."learning_content" from "authenticated";

revoke references on table "public"."learning_content" from "authenticated";

revoke select on table "public"."learning_content" from "authenticated";

revoke trigger on table "public"."learning_content" from "authenticated";

revoke truncate on table "public"."learning_content" from "authenticated";

revoke update on table "public"."learning_content" from "authenticated";

revoke delete on table "public"."learning_content" from "service_role";

revoke insert on table "public"."learning_content" from "service_role";

revoke references on table "public"."learning_content" from "service_role";

revoke select on table "public"."learning_content" from "service_role";

revoke trigger on table "public"."learning_content" from "service_role";

revoke truncate on table "public"."learning_content" from "service_role";

revoke update on table "public"."learning_content" from "service_role";

revoke delete on table "public"."merge_operations" from "anon";

revoke insert on table "public"."merge_operations" from "anon";

revoke references on table "public"."merge_operations" from "anon";

revoke select on table "public"."merge_operations" from "anon";

revoke trigger on table "public"."merge_operations" from "anon";

revoke truncate on table "public"."merge_operations" from "anon";

revoke update on table "public"."merge_operations" from "anon";

revoke delete on table "public"."merge_operations" from "authenticated";

revoke insert on table "public"."merge_operations" from "authenticated";

revoke references on table "public"."merge_operations" from "authenticated";

revoke select on table "public"."merge_operations" from "authenticated";

revoke trigger on table "public"."merge_operations" from "authenticated";

revoke truncate on table "public"."merge_operations" from "authenticated";

revoke update on table "public"."merge_operations" from "authenticated";

revoke delete on table "public"."merge_operations" from "service_role";

revoke insert on table "public"."merge_operations" from "service_role";

revoke references on table "public"."merge_operations" from "service_role";

revoke select on table "public"."merge_operations" from "service_role";

revoke trigger on table "public"."merge_operations" from "service_role";

revoke truncate on table "public"."merge_operations" from "service_role";

revoke update on table "public"."merge_operations" from "service_role";

revoke delete on table "public"."nft_collectibles" from "anon";

revoke insert on table "public"."nft_collectibles" from "anon";

revoke references on table "public"."nft_collectibles" from "anon";

revoke select on table "public"."nft_collectibles" from "anon";

revoke trigger on table "public"."nft_collectibles" from "anon";

revoke truncate on table "public"."nft_collectibles" from "anon";

revoke update on table "public"."nft_collectibles" from "anon";

revoke delete on table "public"."nft_collectibles" from "authenticated";

revoke insert on table "public"."nft_collectibles" from "authenticated";

revoke references on table "public"."nft_collectibles" from "authenticated";

revoke select on table "public"."nft_collectibles" from "authenticated";

revoke trigger on table "public"."nft_collectibles" from "authenticated";

revoke truncate on table "public"."nft_collectibles" from "authenticated";

revoke update on table "public"."nft_collectibles" from "authenticated";

revoke delete on table "public"."nft_collectibles" from "service_role";

revoke insert on table "public"."nft_collectibles" from "service_role";

revoke references on table "public"."nft_collectibles" from "service_role";

revoke select on table "public"."nft_collectibles" from "service_role";

revoke trigger on table "public"."nft_collectibles" from "service_role";

revoke truncate on table "public"."nft_collectibles" from "service_role";

revoke update on table "public"."nft_collectibles" from "service_role";

revoke delete on table "public"."pipeline_steps" from "anon";

revoke insert on table "public"."pipeline_steps" from "anon";

revoke references on table "public"."pipeline_steps" from "anon";

revoke select on table "public"."pipeline_steps" from "anon";

revoke trigger on table "public"."pipeline_steps" from "anon";

revoke truncate on table "public"."pipeline_steps" from "anon";

revoke update on table "public"."pipeline_steps" from "anon";

revoke delete on table "public"."pipeline_steps" from "authenticated";

revoke insert on table "public"."pipeline_steps" from "authenticated";

revoke references on table "public"."pipeline_steps" from "authenticated";

revoke select on table "public"."pipeline_steps" from "authenticated";

revoke trigger on table "public"."pipeline_steps" from "authenticated";

revoke truncate on table "public"."pipeline_steps" from "authenticated";

revoke update on table "public"."pipeline_steps" from "authenticated";

revoke delete on table "public"."pipeline_steps" from "service_role";

revoke insert on table "public"."pipeline_steps" from "service_role";

revoke references on table "public"."pipeline_steps" from "service_role";

revoke select on table "public"."pipeline_steps" from "service_role";

revoke trigger on table "public"."pipeline_steps" from "service_role";

revoke truncate on table "public"."pipeline_steps" from "service_role";

revoke update on table "public"."pipeline_steps" from "service_role";

revoke delete on table "public"."plot_overviews" from "anon";

revoke insert on table "public"."plot_overviews" from "anon";

revoke references on table "public"."plot_overviews" from "anon";

revoke select on table "public"."plot_overviews" from "anon";

revoke trigger on table "public"."plot_overviews" from "anon";

revoke truncate on table "public"."plot_overviews" from "anon";

revoke update on table "public"."plot_overviews" from "anon";

revoke delete on table "public"."plot_overviews" from "authenticated";

revoke insert on table "public"."plot_overviews" from "authenticated";

revoke references on table "public"."plot_overviews" from "authenticated";

revoke select on table "public"."plot_overviews" from "authenticated";

revoke trigger on table "public"."plot_overviews" from "authenticated";

revoke truncate on table "public"."plot_overviews" from "authenticated";

revoke update on table "public"."plot_overviews" from "authenticated";

revoke delete on table "public"."plot_overviews" from "service_role";

revoke insert on table "public"."plot_overviews" from "service_role";

revoke references on table "public"."plot_overviews" from "service_role";

revoke select on table "public"."plot_overviews" from "service_role";

revoke trigger on table "public"."plot_overviews" from "service_role";

revoke truncate on table "public"."plot_overviews" from "service_role";

revoke update on table "public"."plot_overviews" from "service_role";

revoke delete on table "public"."profiles" from "anon";

revoke insert on table "public"."profiles" from "anon";

revoke references on table "public"."profiles" from "anon";

revoke select on table "public"."profiles" from "anon";

revoke trigger on table "public"."profiles" from "anon";

revoke truncate on table "public"."profiles" from "anon";

revoke update on table "public"."profiles" from "anon";

revoke delete on table "public"."profiles" from "authenticated";

revoke insert on table "public"."profiles" from "authenticated";

revoke references on table "public"."profiles" from "authenticated";

revoke select on table "public"."profiles" from "authenticated";

revoke trigger on table "public"."profiles" from "authenticated";

revoke truncate on table "public"."profiles" from "authenticated";

revoke update on table "public"."profiles" from "authenticated";

revoke delete on table "public"."profiles" from "service_role";

revoke insert on table "public"."profiles" from "service_role";

revoke references on table "public"."profiles" from "service_role";

revoke select on table "public"."profiles" from "service_role";

revoke trigger on table "public"."profiles" from "service_role";

revoke truncate on table "public"."profiles" from "service_role";

revoke update on table "public"."profiles" from "service_role";

revoke delete on table "public"."quiz_attempts" from "anon";

revoke insert on table "public"."quiz_attempts" from "anon";

revoke references on table "public"."quiz_attempts" from "anon";

revoke select on table "public"."quiz_attempts" from "anon";

revoke trigger on table "public"."quiz_attempts" from "anon";

revoke truncate on table "public"."quiz_attempts" from "anon";

revoke update on table "public"."quiz_attempts" from "anon";

revoke delete on table "public"."quiz_attempts" from "authenticated";

revoke insert on table "public"."quiz_attempts" from "authenticated";

revoke references on table "public"."quiz_attempts" from "authenticated";

revoke select on table "public"."quiz_attempts" from "authenticated";

revoke trigger on table "public"."quiz_attempts" from "authenticated";

revoke truncate on table "public"."quiz_attempts" from "authenticated";

revoke update on table "public"."quiz_attempts" from "authenticated";

revoke delete on table "public"."quiz_attempts" from "service_role";

revoke insert on table "public"."quiz_attempts" from "service_role";

revoke references on table "public"."quiz_attempts" from "service_role";

revoke select on table "public"."quiz_attempts" from "service_role";

revoke trigger on table "public"."quiz_attempts" from "service_role";

revoke truncate on table "public"."quiz_attempts" from "service_role";

revoke update on table "public"."quiz_attempts" from "service_role";

revoke delete on table "public"."quizzes" from "anon";

revoke insert on table "public"."quizzes" from "anon";

revoke references on table "public"."quizzes" from "anon";

revoke select on table "public"."quizzes" from "anon";

revoke trigger on table "public"."quizzes" from "anon";

revoke truncate on table "public"."quizzes" from "anon";

revoke update on table "public"."quizzes" from "anon";

revoke delete on table "public"."quizzes" from "authenticated";

revoke insert on table "public"."quizzes" from "authenticated";

revoke references on table "public"."quizzes" from "authenticated";

revoke select on table "public"."quizzes" from "authenticated";

revoke trigger on table "public"."quizzes" from "authenticated";

revoke truncate on table "public"."quizzes" from "authenticated";

revoke update on table "public"."quizzes" from "authenticated";

revoke delete on table "public"."quizzes" from "service_role";

revoke insert on table "public"."quizzes" from "service_role";

revoke references on table "public"."quizzes" from "service_role";

revoke select on table "public"."quizzes" from "service_role";

revoke trigger on table "public"."quizzes" from "service_role";

revoke truncate on table "public"."quizzes" from "service_role";

revoke update on table "public"."quizzes" from "service_role";

revoke delete on table "public"."scripts" from "anon";

revoke insert on table "public"."scripts" from "anon";

revoke references on table "public"."scripts" from "anon";

revoke select on table "public"."scripts" from "anon";

revoke trigger on table "public"."scripts" from "anon";

revoke truncate on table "public"."scripts" from "anon";

revoke update on table "public"."scripts" from "anon";

revoke delete on table "public"."scripts" from "authenticated";

revoke insert on table "public"."scripts" from "authenticated";

revoke references on table "public"."scripts" from "authenticated";

revoke select on table "public"."scripts" from "authenticated";

revoke trigger on table "public"."scripts" from "authenticated";

revoke truncate on table "public"."scripts" from "authenticated";

revoke update on table "public"."scripts" from "authenticated";

revoke delete on table "public"."scripts" from "service_role";

revoke insert on table "public"."scripts" from "service_role";

revoke references on table "public"."scripts" from "service_role";

revoke select on table "public"."scripts" from "service_role";

revoke trigger on table "public"."scripts" from "service_role";

revoke truncate on table "public"."scripts" from "service_role";

revoke update on table "public"."scripts" from "service_role";

revoke delete on table "public"."story_choices" from "anon";

revoke insert on table "public"."story_choices" from "anon";

revoke references on table "public"."story_choices" from "anon";

revoke select on table "public"."story_choices" from "anon";

revoke trigger on table "public"."story_choices" from "anon";

revoke truncate on table "public"."story_choices" from "anon";

revoke update on table "public"."story_choices" from "anon";

revoke delete on table "public"."story_choices" from "authenticated";

revoke insert on table "public"."story_choices" from "authenticated";

revoke references on table "public"."story_choices" from "authenticated";

revoke select on table "public"."story_choices" from "authenticated";

revoke trigger on table "public"."story_choices" from "authenticated";

revoke truncate on table "public"."story_choices" from "authenticated";

revoke update on table "public"."story_choices" from "authenticated";

revoke delete on table "public"."story_choices" from "service_role";

revoke insert on table "public"."story_choices" from "service_role";

revoke references on table "public"."story_choices" from "service_role";

revoke select on table "public"."story_choices" from "service_role";

revoke trigger on table "public"."story_choices" from "service_role";

revoke truncate on table "public"."story_choices" from "service_role";

revoke update on table "public"."story_choices" from "service_role";

revoke delete on table "public"."subscription_history" from "anon";

revoke insert on table "public"."subscription_history" from "anon";

revoke references on table "public"."subscription_history" from "anon";

revoke select on table "public"."subscription_history" from "anon";

revoke trigger on table "public"."subscription_history" from "anon";

revoke truncate on table "public"."subscription_history" from "anon";

revoke update on table "public"."subscription_history" from "anon";

revoke delete on table "public"."subscription_history" from "authenticated";

revoke insert on table "public"."subscription_history" from "authenticated";

revoke references on table "public"."subscription_history" from "authenticated";

revoke select on table "public"."subscription_history" from "authenticated";

revoke trigger on table "public"."subscription_history" from "authenticated";

revoke truncate on table "public"."subscription_history" from "authenticated";

revoke update on table "public"."subscription_history" from "authenticated";

revoke delete on table "public"."subscription_history" from "service_role";

revoke insert on table "public"."subscription_history" from "service_role";

revoke references on table "public"."subscription_history" from "service_role";

revoke select on table "public"."subscription_history" from "service_role";

revoke trigger on table "public"."subscription_history" from "service_role";

revoke truncate on table "public"."subscription_history" from "service_role";

revoke update on table "public"."subscription_history" from "service_role";

revoke delete on table "public"."subscription_tiers" from "anon";

revoke insert on table "public"."subscription_tiers" from "anon";

revoke references on table "public"."subscription_tiers" from "anon";

revoke select on table "public"."subscription_tiers" from "anon";

revoke trigger on table "public"."subscription_tiers" from "anon";

revoke truncate on table "public"."subscription_tiers" from "anon";

revoke update on table "public"."subscription_tiers" from "anon";

revoke delete on table "public"."subscription_tiers" from "authenticated";

revoke insert on table "public"."subscription_tiers" from "authenticated";

revoke references on table "public"."subscription_tiers" from "authenticated";

revoke select on table "public"."subscription_tiers" from "authenticated";

revoke trigger on table "public"."subscription_tiers" from "authenticated";

revoke truncate on table "public"."subscription_tiers" from "authenticated";

revoke update on table "public"."subscription_tiers" from "authenticated";

revoke delete on table "public"."subscription_tiers" from "service_role";

revoke insert on table "public"."subscription_tiers" from "service_role";

revoke references on table "public"."subscription_tiers" from "service_role";

revoke select on table "public"."subscription_tiers" from "service_role";

revoke trigger on table "public"."subscription_tiers" from "service_role";

revoke truncate on table "public"."subscription_tiers" from "service_role";

revoke update on table "public"."subscription_tiers" from "service_role";

revoke delete on table "public"."usage_logs" from "anon";

revoke insert on table "public"."usage_logs" from "anon";

revoke references on table "public"."usage_logs" from "anon";

revoke select on table "public"."usage_logs" from "anon";

revoke trigger on table "public"."usage_logs" from "anon";

revoke truncate on table "public"."usage_logs" from "anon";

revoke update on table "public"."usage_logs" from "anon";

revoke delete on table "public"."usage_logs" from "authenticated";

revoke insert on table "public"."usage_logs" from "authenticated";

revoke references on table "public"."usage_logs" from "authenticated";

revoke select on table "public"."usage_logs" from "authenticated";

revoke trigger on table "public"."usage_logs" from "authenticated";

revoke truncate on table "public"."usage_logs" from "authenticated";

revoke update on table "public"."usage_logs" from "authenticated";

revoke delete on table "public"."usage_logs" from "service_role";

revoke insert on table "public"."usage_logs" from "service_role";

revoke references on table "public"."usage_logs" from "service_role";

revoke select on table "public"."usage_logs" from "service_role";

revoke trigger on table "public"."usage_logs" from "service_role";

revoke truncate on table "public"."usage_logs" from "service_role";

revoke update on table "public"."usage_logs" from "service_role";

revoke delete on table "public"."user_badges" from "anon";

revoke insert on table "public"."user_badges" from "anon";

revoke references on table "public"."user_badges" from "anon";

revoke select on table "public"."user_badges" from "anon";

revoke trigger on table "public"."user_badges" from "anon";

revoke truncate on table "public"."user_badges" from "anon";

revoke update on table "public"."user_badges" from "anon";

revoke delete on table "public"."user_badges" from "authenticated";

revoke insert on table "public"."user_badges" from "authenticated";

revoke references on table "public"."user_badges" from "authenticated";

revoke select on table "public"."user_badges" from "authenticated";

revoke trigger on table "public"."user_badges" from "authenticated";

revoke truncate on table "public"."user_badges" from "authenticated";

revoke update on table "public"."user_badges" from "authenticated";

revoke delete on table "public"."user_badges" from "service_role";

revoke insert on table "public"."user_badges" from "service_role";

revoke references on table "public"."user_badges" from "service_role";

revoke select on table "public"."user_badges" from "service_role";

revoke trigger on table "public"."user_badges" from "service_role";

revoke truncate on table "public"."user_badges" from "service_role";

revoke update on table "public"."user_badges" from "service_role";

revoke delete on table "public"."user_collectibles" from "anon";

revoke insert on table "public"."user_collectibles" from "anon";

revoke references on table "public"."user_collectibles" from "anon";

revoke select on table "public"."user_collectibles" from "anon";

revoke trigger on table "public"."user_collectibles" from "anon";

revoke truncate on table "public"."user_collectibles" from "anon";

revoke update on table "public"."user_collectibles" from "anon";

revoke delete on table "public"."user_collectibles" from "authenticated";

revoke insert on table "public"."user_collectibles" from "authenticated";

revoke references on table "public"."user_collectibles" from "authenticated";

revoke select on table "public"."user_collectibles" from "authenticated";

revoke trigger on table "public"."user_collectibles" from "authenticated";

revoke truncate on table "public"."user_collectibles" from "authenticated";

revoke update on table "public"."user_collectibles" from "authenticated";

revoke delete on table "public"."user_collectibles" from "service_role";

revoke insert on table "public"."user_collectibles" from "service_role";

revoke references on table "public"."user_collectibles" from "service_role";

revoke select on table "public"."user_collectibles" from "service_role";

revoke trigger on table "public"."user_collectibles" from "service_role";

revoke truncate on table "public"."user_collectibles" from "service_role";

revoke update on table "public"."user_collectibles" from "service_role";

revoke delete on table "public"."user_progress" from "anon";

revoke insert on table "public"."user_progress" from "anon";

revoke references on table "public"."user_progress" from "anon";

revoke select on table "public"."user_progress" from "anon";

revoke trigger on table "public"."user_progress" from "anon";

revoke truncate on table "public"."user_progress" from "anon";

revoke update on table "public"."user_progress" from "anon";

revoke delete on table "public"."user_progress" from "authenticated";

revoke insert on table "public"."user_progress" from "authenticated";

revoke references on table "public"."user_progress" from "authenticated";

revoke select on table "public"."user_progress" from "authenticated";

revoke trigger on table "public"."user_progress" from "authenticated";

revoke truncate on table "public"."user_progress" from "authenticated";

revoke update on table "public"."user_progress" from "authenticated";

revoke delete on table "public"."user_progress" from "service_role";

revoke insert on table "public"."user_progress" from "service_role";

revoke references on table "public"."user_progress" from "service_role";

revoke select on table "public"."user_progress" from "service_role";

revoke trigger on table "public"."user_progress" from "service_role";

revoke truncate on table "public"."user_progress" from "service_role";

revoke update on table "public"."user_progress" from "service_role";

revoke delete on table "public"."user_story_progress" from "anon";

revoke insert on table "public"."user_story_progress" from "anon";

revoke references on table "public"."user_story_progress" from "anon";

revoke select on table "public"."user_story_progress" from "anon";

revoke trigger on table "public"."user_story_progress" from "anon";

revoke truncate on table "public"."user_story_progress" from "anon";

revoke update on table "public"."user_story_progress" from "anon";

revoke delete on table "public"."user_story_progress" from "authenticated";

revoke insert on table "public"."user_story_progress" from "authenticated";

revoke references on table "public"."user_story_progress" from "authenticated";

revoke select on table "public"."user_story_progress" from "authenticated";

revoke trigger on table "public"."user_story_progress" from "authenticated";

revoke truncate on table "public"."user_story_progress" from "authenticated";

revoke update on table "public"."user_story_progress" from "authenticated";

revoke delete on table "public"."user_story_progress" from "service_role";

revoke insert on table "public"."user_story_progress" from "service_role";

revoke references on table "public"."user_story_progress" from "service_role";

revoke select on table "public"."user_story_progress" from "service_role";

revoke trigger on table "public"."user_story_progress" from "service_role";

revoke truncate on table "public"."user_story_progress" from "service_role";

revoke update on table "public"."user_story_progress" from "service_role";

revoke delete on table "public"."user_subscriptions" from "anon";

revoke insert on table "public"."user_subscriptions" from "anon";

revoke references on table "public"."user_subscriptions" from "anon";

revoke select on table "public"."user_subscriptions" from "anon";

revoke trigger on table "public"."user_subscriptions" from "anon";

revoke truncate on table "public"."user_subscriptions" from "anon";

revoke update on table "public"."user_subscriptions" from "anon";

revoke delete on table "public"."user_subscriptions" from "authenticated";

revoke insert on table "public"."user_subscriptions" from "authenticated";

revoke references on table "public"."user_subscriptions" from "authenticated";

revoke select on table "public"."user_subscriptions" from "authenticated";

revoke trigger on table "public"."user_subscriptions" from "authenticated";

revoke truncate on table "public"."user_subscriptions" from "authenticated";

revoke update on table "public"."user_subscriptions" from "authenticated";

revoke delete on table "public"."user_subscriptions" from "service_role";

revoke insert on table "public"."user_subscriptions" from "service_role";

revoke references on table "public"."user_subscriptions" from "service_role";

revoke select on table "public"."user_subscriptions" from "service_role";

revoke trigger on table "public"."user_subscriptions" from "service_role";

revoke truncate on table "public"."user_subscriptions" from "service_role";

revoke update on table "public"."user_subscriptions" from "service_role";

revoke delete on table "public"."video_generations" from "anon";

revoke insert on table "public"."video_generations" from "anon";

revoke references on table "public"."video_generations" from "anon";

revoke select on table "public"."video_generations" from "anon";

revoke trigger on table "public"."video_generations" from "anon";

revoke truncate on table "public"."video_generations" from "anon";

revoke update on table "public"."video_generations" from "anon";

revoke delete on table "public"."video_generations" from "authenticated";

revoke insert on table "public"."video_generations" from "authenticated";

revoke references on table "public"."video_generations" from "authenticated";

revoke select on table "public"."video_generations" from "authenticated";

revoke trigger on table "public"."video_generations" from "authenticated";

revoke truncate on table "public"."video_generations" from "authenticated";

revoke update on table "public"."video_generations" from "authenticated";

revoke delete on table "public"."video_generations" from "service_role";

revoke insert on table "public"."video_generations" from "service_role";

revoke references on table "public"."video_generations" from "service_role";

revoke select on table "public"."video_generations" from "service_role";

revoke trigger on table "public"."video_generations" from "service_role";

revoke truncate on table "public"."video_generations" from "service_role";

revoke update on table "public"."video_generations" from "service_role";

revoke delete on table "public"."video_segments" from "anon";

revoke insert on table "public"."video_segments" from "anon";

revoke references on table "public"."video_segments" from "anon";

revoke select on table "public"."video_segments" from "anon";

revoke trigger on table "public"."video_segments" from "anon";

revoke truncate on table "public"."video_segments" from "anon";

revoke update on table "public"."video_segments" from "anon";

revoke delete on table "public"."video_segments" from "authenticated";

revoke insert on table "public"."video_segments" from "authenticated";

revoke references on table "public"."video_segments" from "authenticated";

revoke select on table "public"."video_segments" from "authenticated";

revoke trigger on table "public"."video_segments" from "authenticated";

revoke truncate on table "public"."video_segments" from "authenticated";

revoke update on table "public"."video_segments" from "authenticated";

revoke delete on table "public"."video_segments" from "service_role";

revoke insert on table "public"."video_segments" from "service_role";

revoke references on table "public"."video_segments" from "service_role";

revoke select on table "public"."video_segments" from "service_role";

revoke trigger on table "public"."video_segments" from "service_role";

revoke truncate on table "public"."video_segments" from "service_role";

revoke update on table "public"."video_segments" from "service_role";

revoke delete on table "public"."videos" from "anon";

revoke insert on table "public"."videos" from "anon";

revoke references on table "public"."videos" from "anon";

revoke select on table "public"."videos" from "anon";

revoke trigger on table "public"."videos" from "anon";

revoke truncate on table "public"."videos" from "anon";

revoke update on table "public"."videos" from "anon";

revoke delete on table "public"."videos" from "authenticated";

revoke insert on table "public"."videos" from "authenticated";

revoke references on table "public"."videos" from "authenticated";

revoke select on table "public"."videos" from "authenticated";

revoke trigger on table "public"."videos" from "authenticated";

revoke truncate on table "public"."videos" from "authenticated";

revoke update on table "public"."videos" from "authenticated";

revoke delete on table "public"."videos" from "service_role";

revoke insert on table "public"."videos" from "service_role";

revoke references on table "public"."videos" from "service_role";

revoke select on table "public"."videos" from "service_role";

revoke trigger on table "public"."videos" from "service_role";

revoke truncate on table "public"."videos" from "service_role";

revoke update on table "public"."videos" from "service_role";

alter table "public"."chapter_scripts" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."character_archetypes" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."characters" alter column "id" set default extensions.uuid_generate_v4();

alter table "public"."plot_overviews" alter column "id" set default extensions.uuid_generate_v4();

set check_function_bodies = off;

CREATE OR REPLACE FUNCTION public.check_usage_limit(p_user_id uuid)
 RETURNS boolean
 LANGUAGE plpgsql
AS $function$
DECLARE
    v_subscription RECORD;
BEGIN
    SELECT * INTO v_subscription
    FROM user_subscriptions
    WHERE user_id = p_user_id
    AND status = 'active';
    
    IF NOT FOUND THEN
        -- No active subscription, use free tier limits
        SELECT * INTO v_subscription
        FROM subscription_tiers
        WHERE tier = 'free';
        RETURN true; -- Allow free tier by default
    END IF;
    
    -- Check if within limits
    RETURN v_subscription.videos_generated_this_period < v_subscription.monthly_video_limit;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.increment_usage(p_user_id uuid, p_resource_id uuid DEFAULT NULL::uuid)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
DECLARE
    v_subscription RECORD;
BEGIN
    -- Get current subscription
    SELECT * INTO v_subscription
    FROM user_subscriptions
    WHERE user_id = p_user_id
    AND status = 'active'
    FOR UPDATE;
    
    IF FOUND THEN
        -- Increment usage counter
        UPDATE user_subscriptions
        SET videos_generated_this_period = videos_generated_this_period + 1,
            updated_at = NOW()
        WHERE id = v_subscription.id;
        
        -- Log usage
        INSERT INTO usage_logs (
            user_id,
            subscription_id,
            resource_type,
            resource_id,
            billing_period_start,
            billing_period_end
        ) VALUES (
            p_user_id,
            v_subscription.id,
            'video_generation',
            p_resource_id,
            v_subscription.current_period_start,
            v_subscription.current_period_end
        );
    ELSE
        -- Create free subscription if none exists
        INSERT INTO user_subscriptions (
            user_id,
            tier,
            status,
            monthly_video_limit,
            videos_generated_this_period,
            current_period_start,
            current_period_end
        ) VALUES (
            p_user_id,
            'free',
            'active',
            2,
            1,
            NOW(),
            NOW() + INTERVAL '30 days'
        )
        ON CONFLICT (user_id) DO UPDATE
        SET videos_generated_this_period = user_subscriptions.videos_generated_this_period + 1;
    END IF;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.match_book_embeddings(query_embedding vector, match_threshold double precision, match_count integer)
 RETURNS TABLE(id uuid, book_id uuid, content_chunk text, chunk_type text, chunk_index integer, similarity double precision)
 LANGUAGE plpgsql
AS $function$
BEGIN
  RETURN QUERY
  SELECT
    be.id,
    be.book_id,
    be.content_chunk,
    be.chunk_type,
    be.chunk_index,
    1 - (be.embedding <=> query_embedding) AS similarity
  FROM book_embeddings be
  WHERE 1 - (be.embedding <=> query_embedding) > match_threshold
  ORDER BY be.embedding <=> query_embedding
  LIMIT match_count;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.match_chapter_embeddings(query_embedding vector, match_threshold double precision, match_count integer)
 RETURNS TABLE(id uuid, chapter_id uuid, book_id uuid, content_chunk text, chunk_index integer, similarity double precision)
 LANGUAGE plpgsql
AS $function$
BEGIN
  RETURN QUERY
  SELECT
    ce.id,
    ce.chapter_id,
    ce.book_id,
    ce.content_chunk,
    ce.chunk_index,
    1 - (ce.embedding <=> query_embedding) AS similarity
  FROM chapter_embeddings ce
  WHERE 1 - (ce.embedding <=> query_embedding) > match_threshold
  ORDER BY ce.embedding <=> query_embedding
  LIMIT match_count;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.reset_monthly_usage()
 RETURNS integer
 LANGUAGE plpgsql
AS $function$
DECLARE
    rows_updated INTEGER;
BEGIN
    UPDATE user_subscriptions
    SET videos_generated_this_period = 0,
        current_period_start = NOW(),
        current_period_end = NOW() + INTERVAL '30 days',
        updated_at = NOW()
    WHERE current_period_end <= NOW()
    AND status = 'active';
    
    GET DIAGNOSTICS rows_updated = ROW_COUNT;
    RETURN rows_updated;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_learning_content_updated_at()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_updated_at_column()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END;
$function$
;



